#!/bin/bash

TARGETFILE=$HOME/.bashrc

# create file if not exist
[ ! -f $TARGETFILE ] && touch $TARGETFILE || echo "$TARGETFILE Found"


# read data from the file
while read -r configline ; do
	#trim line
	line="${configline##*( )}"
	line="${configline%%*( )}"
	# skip empty lines
	[ -z "$configline" ] && continue
	# skip comments
	[[ ${configline:0:1} == "#" ]] && continue

	# now we search the config file
	if grep -q "$configline" $TARGETFILE ; then
		echo "Settings [$configline] already exist. Skip."
	else

        # we need to check if the settings already have different value        
  	    if [[ $configline == "export *" ]]; then
                # this is variable string in the config, pars the variable
                VAR=${confitline#export} # remove word export
                VAR=${VAR%%=*} # remove everything after
                if [ -z ${VAR+x} ]; then 
                        #VAR is unset, add to the file
                		echo $configline >> $TARGETFILE
                else 
                        echo "$VAR is set to '$VAR', would you like to add '$configline' (Y/N)?"; 
echo "Do you wish to install this program?"
select yn in "Yes" "No"; do
    case $yn in
        Yes ) make install; break;;
        No ) exit;;
    esac
done

                fi
        else # this is setting, not a variable
        		echo $configline >> $TARGETFILE
        fi


	fi

done<bash.config

# execute bashrc
source $TARGETFILE
